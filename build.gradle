plugins {
    id 'java'
    id 'war'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'jakarta.servlet:jakarta.servlet-api:5.0.0'
    implementation 'jakarta.servlet.jsp:jakarta.servlet.jsp-api:3.0.0'
    implementation 'org.apache.tomcat.embed:tomcat-embed-jasper:10.0.0'
    implementation 'org.glassfish.web:jakarta.servlet.jsp.jstl:2.0.0'
    implementation 'jakarta.annotation:jakarta.annotation-api:2.0.0'
    
    // Change MySQL dependency to be included in WAR
    implementation 'mysql:mysql-connector-java:8.0.26'
    
    providedCompile 'org.apache.tomcat.embed:tomcat-embed-core:10.0.0'
    providedCompile 'jakarta.servlet:jakarta.servlet-api:5.0.0' // or the correct version

}

war {
    archiveFileName = 'OnlineBank.war'
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    
    // Include webapp files
    from('src/main/webapp') {
        include '**/*'
    }
    
    // Include resources
    from('src/main/resources') {
        include '**/*'
        into 'WEB-INF/classes'
    }
}

// Add application context path configuration
tasks.withType(JavaExec) {
    systemProperty 'server.servlet.context-path', '/OnlineBank'
}
